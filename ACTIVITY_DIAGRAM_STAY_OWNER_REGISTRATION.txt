@startuml Stay_Owner_Registration_Activity_Diagram

!theme plain
skinparam backgroundColor #FFFFFF
skinparam ActivityBackgroundColor #E8F4F8
skinparam ActivityBorderColor #0066B2
skinparam ArrowColor #333333
skinparam fontSize 11

title Stay Owner Registration Process (UML Activity Diagram)

(*) --> "Accommodation owner\nclicks \"Register\""
--> "Select role:\n\"Stay Owner\""
--> "Enter personal info:\nName, Email, Phone"
--> "Create password\n(strong requirements)"
--> "Confirm password"
--> ===S1===
partition System {
  === S1 ===
  --> "Validate email format"
  --> <<decision>>
  if "Email Valid?" then
    --> [Yes] "Check if email\nalready registered"
  else
    --> [No] "Return error:\nInvalid email"
    --> (*)
  endif
}
--> <<decision>>
if "Email Exists?" then
  --> [Yes] "Return error:\nEmail already registered"
  --> (*)
else
  --> [No] "Validate password\nstrength"
endif
--> <<decision>>
if "Password Strong?" then
  --> [Yes] "Check passwords\nmatch"
else
  --> [No] "Return error:\nPassword requirements"
  --> (*)
endif
--> <<decision>>
if "Passwords Match?" then
  --> [Yes] "Create user account"
else
  --> [No] "Return error:\nPasswords don't match"
  --> (*)
endif
--> ===S2===
partition System {
  === S2 ===
  --> "Create User record\nwith role = \"stay_owner\""
  --> "Set is_approved =\nFalse"
  --> "Hash password\n(bcrypt)"
  --> "Generate email\nverification token"
  --> "Send verification\nemail to user"
}
--> "Display message:\nCheck your email"
--> "Owner clicks email\nverification link"
--> ===S3===
partition System {
  === S3 ===
  --> "Validate verification\ntoken"
  --> <<decision>>
  if "Token Valid?" then
    --> [Yes] "Mark email\nas verified"
  else
    --> [No] "Return error:\nToken expired/invalid"
    --> (*)
  endif
}
--> "Enter stay details:\nName, Type, District"
--> "Add accommodation info:\nPrice, Amenities, Photos"
--> "Enter contact info:\nEmail, Phone, WhatsApp"
--> "Add booking preference:\nInternal or Affiliate"
--> ===S4===
partition System {
  === S4 ===
  --> "Upload stay images"
  --> "Validate image format\nand size"
  --> <<decision>>
  if "Images Valid?" then
    --> [Yes] "Store images\nin media folder"
  else
    --> [No] "Return error:\nInvalid images"
    --> (*)
  endif
}
--> "Upload business\nregistration document"
--> "Enter business\nregistration number"
--> ===S5===
partition System {
  === S5 ===
  --> "Create Stay\nrecord in database"
  --> "Link Stay to\nUser (owner_id)"
  --> "Set is_internal =\ntrue/false based on choice"
  --> "Set is_active = False\n(pending approval)"
  --> "Notify admin:\nNew stay owner registered"
}
--> "Display message:\nAwaiting admin approval"
--> "Admin reviews\napplication"
--> "Admin verifies:\nDocuments, Info"
--> <<decision>>
if "Approved?" then
  --> [Yes] "Set is_approved = True"
  --> "Set Stay.is_active = True"
  --> "Send approval email"
else
  --> [No] "Set is_approved = False"
  --> "Send rejection email"
  --> (*)
endif
--> "Owner receives\napproval notification"
--> "Owner can now manage\ntheir stay listing"
--> (*)

@enduml
