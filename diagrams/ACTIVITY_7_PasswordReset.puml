@startuml Password Reset Activity

title Password Reset Workflow

skinparam backgroundColor #FEFEFE

|#LightBlue|User|
|#EEEEEE|System|

start

|User|
:Click Forgot Password;
:Enter Email;

|System|
if (User Exists?) then (yes)
    :Generate Token;
    :Send Reset Email;
    
    |User|
    :Click Reset Link;
    
    |System|
    if (Token Valid?) then (yes)
        :Show Reset Form;
        
        |User|
        :Enter New Password;
        :Confirm Password;
        
        |System|
        if (Passwords Match?) then (yes)
            :Update Password;
            :Invalidate Token;
            
            |User|
            :Reset Complete;
        else (no)
            :Show Error;
        endif
    else (no)
        :Token Expired;
    endif
else (no)
    :Show Success Message;
    note right: Security - don't\nreveal if exists
endif

stop

@enduml
