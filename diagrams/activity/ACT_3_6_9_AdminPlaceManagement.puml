@startuml Admin Place Management Activity

title Figure 3.X: Admin Place Management Activity Diagram

skinparam backgroundColor #FEFEFE
skinparam ActivityBackgroundColor #E3F2FD
skinparam ActivityBorderColor #1976D2
skinparam ActivityDiamondBackgroundColor #FFF9C4
skinparam ActivityDiamondBorderColor #F57F17
skinparam ArrowColor #333333

|#FFE0B2|Admin|
|#E8F5E9|System|
|#FFF3E0|Database|

|Admin|
start
:Login to Admin Portal;

|System|
:Validate Admin Credentials;
:Check role = 'admin';
:Generate JWT Tokens;

|Admin|
:Access Admin Dashboard;
:Navigate to "Places" Section;

|System|
:Fetch Existing Places;

|Database|
:SELECT * FROM places
ORDER BY created_at DESC;

|System|
:Display Places List
with Search & Filters;

|Admin|
:Click "Add New Place";

|System|
:Display Place Creation Form;

|Admin|
:Fill Place Details
== Basic Information ==
- Name *
- Description
- Category (Heritage/Museum/Beach/Park...)

== Location ==
- City *
- State
- Country
- Address
- Latitude/Longitude

== Pricing ==
- Is Free? (checkbox)
- Entry Price
- Currency (MYR)

== Contact ==
- Phone Number
- Email
- Opening Hours
- Best Time to Visit

== External Links ==
- Wikipedia URL
- Official Website
- TripAdvisor URL
- Google Maps URL

== Media ==
- Upload Image / Image URL

== Settings ==
- Is Open (operational status)
- Is Council Managed;

|System|
:Validate Required Fields;

if (Valid Data?) then (yes)
    :Process Image Upload
    (if provided);
    
    if (Image Uploaded?) then (yes)
        :Save Image to Media Storage;
        :Generate Image URL;
    else (no)
        :Use Default or
        Provided URL;
    endif
    
    |Database|
    :INSERT INTO places
    (name, description, category,
    city, state, country,
    latitude, longitude,
    is_free, price, currency,
    contact_phone, contact_email,
    opening_hours, best_time_to_visit,
    wikipedia_url, official_website,
    tripadvisor_url, google_maps_url,
    image_url, is_open,
    is_council_managed,
    created_by = admin_id);
    
    |System|
    :Place Created Successfully;
    :Refresh Places List;
    
    |Admin|
    :Display Success Message
    "Place created successfully!";
    :View New Place in List;
    
else (no)
    |Admin|
    :Display Validation Errors
    - Required fields missing
    - Invalid coordinates
    - Invalid URLs;
    note right: Return to form
endif

' === EDIT PLACE ===
|Admin|
:Select Place to Edit;

|System|
:Fetch Place Details;

|Database|
:SELECT * FROM places
WHERE id = {place_id};

|Admin|
:Display Edit Form
with Current Values;
:Modify Place Details;

|System|
:Validate Updated Fields;

if (Valid Updates?) then (yes)
    |Database|
    :UPDATE places
    SET ... WHERE id = {place_id};
    
    |Admin|
    :Display "Place updated successfully!";
else (no)
    |Admin|
    :Display Validation Errors;
endif

' === DELETE PLACE ===
|Admin|
:Select Place to Delete;
:Confirm Deletion Dialog
"Are you sure? This will also
delete related social posts.";

if (Confirm Delete?) then (yes)
    |System|
    :Check for Related Records;
    
    |Database|
    :UPDATE social_posts
    SET place_id = NULL
    WHERE place_id = {place_id};
    
    :DELETE FROM places
    WHERE id = {place_id};
    
    |Admin|
    :Display "Place deleted successfully!";
    :Refresh Places List;
else (no)
    |Admin|
    :Cancel Deletion;
endif

' === TOGGLE PLACE STATUS ===
|Admin|
:Toggle "Is Open" Status;

|System|
:Update Place Status;

|Database|
:UPDATE places
SET is_open = NOT is_open
WHERE id = {place_id};

|Admin|
:Status Updated
(Open â†” Closed);

' === VIEW PLACE ANALYTICS ===
|Admin|
:Click "View Analytics"
on Place;

|System|
:Fetch Place Sentiment Data;

|Database|
:SELECT sentiment, COUNT(*)
FROM social_posts
WHERE place_id = {place_id}
GROUP BY sentiment;

|System|
:Display Place Analytics
- Social Post Count
- Sentiment Distribution
- Engagement Metrics;

|Admin|
:Review Place Performance;

stop

@enduml
