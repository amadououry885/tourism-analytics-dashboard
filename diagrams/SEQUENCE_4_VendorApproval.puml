@startuml Vendor Registration Approval Sequence

title Vendor Registration & Approval

skinparam backgroundColor #FEFEFE
skinparam sequenceArrowThickness 2

actor Vendor as V #Orange
actor Admin as A #Red
participant "Frontend\n(React)" as FE #E3F2FD
participant "Backend\n(Django)" as BE #E8F5E9
database "Database" as DB #FFF3E0
participant "Email\nService" as ES #FFEBEE

== Registration Phase ==

V -> FE: Fill registration form
FE -> FE: Validate inputs
FE -> BE: POST /api/auth/register/\n{username, email, password,\nrole: 'vendor', business_details}

BE -> DB: Check username/email unique
DB --> BE: OK

BE -> DB: CREATE User\n(is_approved = false)
DB --> BE: User created

BE -> ES: Send welcome email
ES --> V: Email: "Registration received"

BE -> ES: Notify admin
ES --> A: Email: "New vendor pending"

BE --> FE: 201 Created
FE --> V: "Registration submitted!\nAwaiting approval"

== Approval Phase ==

A -> FE: Login to Admin Portal
FE -> BE: GET /api/auth/admin/users/pending/
BE -> DB: Query pending users
DB --> BE: Pending list
BE --> FE: Users list
FE --> A: Display pending vendors

A -> FE: Review vendor details
A -> FE: Click "Approve"
FE -> BE: POST /api/auth/admin/users/{id}/approve/

BE -> DB: UPDATE User\nSET is_approved = true
DB --> BE: Updated

BE -> ES: Send approval email
ES --> V: Email: "Account approved!"

BE --> FE: 200 OK
FE --> A: "Vendor approved"

== Vendor Access ==

V -> FE: Login with credentials
FE -> BE: POST /api/auth/login/
BE -> DB: Verify credentials
BE -> BE: Check is_approved = true
BE --> FE: JWT tokens
FE --> V: Redirect to Vendor Dashboard

@enduml
